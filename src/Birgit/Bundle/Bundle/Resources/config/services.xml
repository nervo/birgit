<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <parameters>

        <!-- Handler Manager -->
        <parameter key="birgit.handler_manager.class">Birgit\Domain\Handler\HandlerManager</parameter>

        <!-- Worker -->
        <parameter key="birgit.worker.class">Birgit\Domain\Worker\Worker</parameter>

        <!-- Project Handler -->
        <parameter key="birgit.project_handler.git.class">Birgit\Domain\Project\Handler\Git\GitProjectHandler</parameter>

        <!-- Project Environment Handler -->
        <parameter key="birgit.project_environment_handler.local.class">Birgit\Domain\Project\Environment\Handler\Local\LocalProjectEnvironmentHandler</parameter>

        <!-- Task Handler - Build -->
        <parameter key="birgit.task_handler.build_create.class">Birgit\Domain\Task\Handler\Build\BuildCreateTaskHandler</parameter>
        <!-- Task Handler - Host -->
        <parameter key="birgit.task_handler.host_create.class">Birgit\Domain\Task\Handler\Host\HostCreateTaskHandler</parameter>
        <parameter key="birgit.task_handler.host_delete.class">Birgit\Domain\Task\Handler\Host\HostDeleteTaskHandler</parameter>
        <!-- Task Handler - Project -->
        <parameter key="birgit.task_handler.project.class">Birgit\Domain\Task\Handler\Project\ProjectTaskHandler</parameter>
        <parameter key="birgit.task_handler.project_status.class">Birgit\Domain\Task\Handler\Project\ProjectStatusTaskHandler</parameter>
        <parameter key="birgit.task_handler.project_reference.class">Birgit\Domain\Task\Handler\Project\ProjectReferenceTaskHandler</parameter>
        <parameter key="birgit.task_handler.project_reference_revision.class">Birgit\Domain\Task\Handler\Project\ProjectReferenceRevisionTaskHandler</parameter>

        <!-- Task Queue Handler -->
        <parameter key="birgit.task_queue_handler.project.class">Birgit\Domain\Task\Queue\Handler\ProjectTaskQueueHandler</parameter>
        <parameter key="birgit.task_queue_handler.project_reference.class">Birgit\Domain\Task\Queue\Handler\ProjectReferenceTaskQueueHandler</parameter>
        <parameter key="birgit.task_queue_handler.project_reference_revision.class">Birgit\Domain\Task\Queue\Handler\ProjectReferenceRevisionTaskQueueHandler</parameter>
        <parameter key="birgit.task_queue_handler.host.class">Birgit\Domain\Task\Queue\Handler\HostTaskQueueHandler</parameter>
        <parameter key="birgit.task_queue_handler.build.class">Birgit\Domain\Task\Queue\Handler\BuildTaskQueueHandler</parameter>
        <!-- Task Queue Handler - Cron -->
        <parameter key="birgit.task_queue_handler.cron.class">Birgit\Domain\Task\Queue\Handler\Cron\CronTaskQueueHandler</parameter>
        <parameter key="birgit.task_queue_handler.project_cron.class">Birgit\Domain\Task\Queue\Handler\Cron\ProjectCronTaskQueueHandler</parameter>
        <parameter key="birgit.task_queue_handler.project_reference_cron.class">Birgit\Domain\Task\Queue\Handler\Cron\ProjectReferenceCronTaskQueueHandler</parameter>

    </parameters>

    <services>

        <!-- Handler Manager -->
        <service id="birgit.handler_manager" class="%birgit.handler_manager.class%" />

        <!-- Worker -->
        <service id="birgit.worker" class="%birgit.worker.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
        </service>

        <!-- Project Handler -->
        <service id="birgit.project_handler.git" public="false" class="%birgit.project_handler.git.class%">
            <tag name="birgit.project_handler" />
        </service>

        <!-- Project Environment Handler -->
        <service id="birgit.project_environment_handler.local" public="false" class="%birgit.project_environment_handler.local.class%">
            <argument>%kernel.root_dir%</argument>
            <tag name="birgit.project_environment_handler" />
        </service>

        <!-- Task Handler - Build -->
        <service id="birgit.task_handler.build_create" public="false" class="%birgit.task_handler.build_create.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.task_manager" />
            <tag name="birgit.task_handler" />
        </service>
        <!-- Task Handler - Host -->
        <service id="birgit.task_handler.host_create" public="false" class="%birgit.task_handler.host_create.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.task_manager" />
            <tag name="birgit.task_handler" />
        </service>
        <service id="birgit.task_handler.host_delete" public="false" class="%birgit.task_handler.host_delete.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.task_manager" />
            <tag name="birgit.task_handler" />
        </service>
        <!-- Task Handler - Project -->
        <service id="birgit.task_handler.project" public="false" class="%birgit.task_handler.project.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.task_manager" />
            <tag name="birgit.task_handler" />
        </service>
        <service id="birgit.task_handler.project_status" public="false" class="%birgit.task_handler.project_status.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.task_manager" />
            <tag name="birgit.task_handler" />
        </service>
        <service id="birgit.task_handler.project_reference" public="false" class="%birgit.task_handler.project_reference.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.task_manager" />
            <tag name="birgit.task_handler" />
        </service>
        <service id="birgit.task_handler.project_reference_revision" public="false" class="%birgit.task_handler.project_reference_revision.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.task_manager" />
            <tag name="birgit.task_handler" />
        </service>

        <!-- Task Queue Handler -->
        <service id="birgit.task_queue_handler.project" public="false" class="%birgit.task_queue_handler.project.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.task_manager" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <service id="birgit.task_queue_handler.project_reference" public="false" class="%birgit.task_queue_handler.project_reference.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.task_manager" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <service id="birgit.task_queue_handler.project_reference_revision" public="false" class="%birgit.task_queue_handler.project_reference_revision.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.task_manager" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <service id="birgit.task_queue_handler.host" public="false" class="%birgit.task_queue_handler.host.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.task_manager" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <service id="birgit.task_queue_handler.build" public="false" class="%birgit.task_queue_handler.build.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.task_manager" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <!-- Task Queue Handler - Cron -->
        <service id="birgit.task_queue_handler.cron" public="false" class="%birgit.task_queue_handler.cron.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.task_manager" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <service id="birgit.task_queue_handler.project_cron" public="false" class="%birgit.task_queue_handler.project_cron.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.task_manager" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <service id="birgit.task_queue_handler.project_reference_cron" public="false" class="%birgit.task_queue_handler.project_reference_cron.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.task_manager" />
            <tag name="birgit.task_queue_handler" />
        </service>

    </services>

</container>
