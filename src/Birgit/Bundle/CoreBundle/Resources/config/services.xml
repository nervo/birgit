<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <parameters>

        <!-- Workflow -->
        <parameter key="birgit.workflow.class">Birgit\Domain\Workflow</parameter>

        <!-- Handler - Manager -->
        <parameter key="birgit.handler_manager.class">Birgit\Domain\Handler\HandlerManager</parameter>

        <!-- Project - Handlers -->
        <parameter key="birgit.project_handler.git.class">Birgit\Domain\Project\Handler\GitProjectHandler</parameter>
        <!-- Project - Task Handlers -->
        <parameter key="birgit.task_handler.project.class">Birgit\Domain\Project\Task\Handler\ProjectTaskHandler</parameter>
        <parameter key="birgit.task_handler.project_status.class">Birgit\Domain\Project\Task\Handler\ProjectStatusTaskHandler</parameter>
        <parameter key="birgit.task_handler.project_reference.class">Birgit\Domain\Project\Task\Handler\ProjectReferenceTaskHandler</parameter>
        <parameter key="birgit.task_handler.project_reference_environments.class">Birgit\Domain\Project\Task\Handler\ProjectReferenceEnvironmentsTaskHandler</parameter>
        <!-- Project - Task Queue Handlers -->
        <parameter key="birgit.task_queue_handler.project.class">Birgit\Domain\Project\Task\Queue\Handler\ProjectTaskQueueHandler</parameter>
        <parameter key="birgit.task_queue_handler.project_reference.class">Birgit\Domain\Project\Task\Queue\Handler\ProjectReferenceTaskQueueHandler</parameter>
        <parameter key="birgit.task_queue_handler.project_reference_create.class">Birgit\Domain\Project\Task\Queue\Handler\ProjectReferenceCreateTaskQueueHandler</parameter>
        <parameter key="birgit.task_queue_handler.project_reference_delete.class">Birgit\Domain\Project\Task\Queue\Handler\ProjectReferenceDeleteTaskQueueHandler</parameter>
        <parameter key="birgit.task_queue_handler.project_reference_revision.class">Birgit\Domain\Project\Task\Queue\Handler\ProjectReferenceRevisionTaskQueueHandler</parameter>
        <parameter key="birgit.task_queue_handler.project_reference_revision_create.class">Birgit\Domain\Project\Task\Queue\Handler\ProjectReferenceRevisionCreateTaskQueueHandler</parameter>
        <!-- Project - Environment Handlers -->
        <parameter key="birgit.project_environment_handler.local.class">Birgit\Domain\Project\Environment\Handler\LocalProjectEnvironmentHandler</parameter>

        <!-- Host - Task Queue Handlers -->
        <parameter key="birgit.task_queue_handler.host.class">Birgit\Domain\Host\Task\Queue\Handler\HostTaskQueueHandler</parameter>
        <parameter key="birgit.task_queue_handler.host_create.class">Birgit\Domain\Host\Task\Queue\Handler\HostCreateTaskQueueHandler</parameter>

        <!-- Cron - Task Queue Handlers -->
        <parameter key="birgit.task_queue_handler.cron.class">Birgit\Domain\Cron\Task\Queue\Handler\CronTaskQueueHandler</parameter>
        <parameter key="birgit.task_queue_handler.project_cron.class">Birgit\Domain\Cron\Task\Queue\Handler\ProjectCronTaskQueueHandler</parameter>
        <parameter key="birgit.task_queue_handler.project_reference_cron.class">Birgit\Domain\Cron\Task\Queue\Handler\ProjectReferenceCronTaskQueueHandler</parameter>

    </parameters>

    <services>

        <!-- Workflow -->
        <service id="birgit.workflow" class="%birgit.workflow.class%">
            <argument type="service" id="birgit.model_manager" />
            <tag name="kernel.event_subscriber" />
        </service>
        
        <!-- Handler - Manager -->
        <service id="birgit.handler_manager" class="%birgit.handler_manager.class%" />

        <!-- Project - Handlers -->
        <service id="birgit.project_handler.git" public="false" class="%birgit.project_handler.git.class%">
            <tag name="birgit.project_handler" />
        </service>
        <!-- Project - Task Handlers -->
        <service id="birgit.task_handler.project" public="false" class="%birgit.task_handler.project.class%">
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="event_dispatcher" />
            <tag name="birgit.task_handler" />
        </service>
        <service id="birgit.task_handler.project_status" public="false" class="%birgit.task_handler.project_status.class%">
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="birgit.handler_manager" />
            <tag name="birgit.task_handler" />
        </service>
        <service id="birgit.task_handler.project_reference" public="false" class="%birgit.task_handler.project_reference.class%">
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="event_dispatcher" />
            <tag name="birgit.task_handler" />
        </service>
        <service id="birgit.task_handler.project_reference_environments" public="false" class="%birgit.task_handler.project_reference_environments.class%">
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="event_dispatcher" />
            <tag name="birgit.task_handler" />
        </service>
        <!-- Project - Task Queue Handlers -->
        <service id="birgit.task_queue_handler.project" public="false" class="%birgit.task_queue_handler.project.class%">
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="event_dispatcher" />
            <argument type="service" id="logger" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <service id="birgit.task_queue_handler.project_reference" public="false" class="%birgit.task_queue_handler.project_reference.class%">
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="event_dispatcher" />
            <argument type="service" id="logger" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <service id="birgit.task_queue_handler.project_reference_create" public="false" class="%birgit.task_queue_handler.project_reference_create.class%">
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="event_dispatcher" />
            <argument type="service" id="logger" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <service id="birgit.task_queue_handler.project_reference_delete" public="false" class="%birgit.task_queue_handler.project_reference_delete.class%">
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="event_dispatcher" />
            <argument type="service" id="logger" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <service id="birgit.task_queue_handler.project_reference_revision" public="false" class="%birgit.task_queue_handler.project_reference_revision.class%">
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="event_dispatcher" />
            <argument type="service" id="logger" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <service id="birgit.task_queue_handler.project_reference_revision_create" public="false" class="%birgit.task_queue_handler.project_reference_revision_create.class%">
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="event_dispatcher" />
            <argument type="service" id="logger" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <!-- Project - Environment Handlers -->
        <service id="birgit.project_environment_handler.local" public="false" class="%birgit.project_environment_handler.local.class%">
            <argument>%kernel.root_dir%</argument>
            <tag name="birgit.project_environment_handler" />
        </service>

        <!-- Host - Task Queue Handlers -->
        <service id="birgit.task_queue_handler.host" public="false" class="%birgit.task_queue_handler.host.class%">
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="event_dispatcher" />
            <argument type="service" id="logger" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <service id="birgit.task_queue_handler.host_create" public="false" class="%birgit.task_queue_handler.host_create.class%">
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="event_dispatcher" />
            <argument type="service" id="logger" />
            <tag name="birgit.task_queue_handler" />
        </service>

        <!-- Cron - Task Queue Handlers -->
        <service id="birgit.task_queue_handler.cron" public="false" class="%birgit.task_queue_handler.cron.class%">
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="event_dispatcher" />
            <argument type="service" id="logger" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <service id="birgit.task_queue_handler.project_cron" public="false" class="%birgit.task_queue_handler.project_cron.class%">
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="event_dispatcher" />
            <argument type="service" id="logger" />
            <tag name="birgit.task_queue_handler" />
        </service>
        <service id="birgit.task_queue_handler.project_reference_cron" public="false" class="%birgit.task_queue_handler.project_reference_cron.class%">
            <argument type="service" id="birgit.handler_manager" />
            <argument type="service" id="birgit.model_manager" />
            <argument type="service" id="event_dispatcher" />
            <argument type="service" id="logger" />
            <tag name="birgit.task_queue_handler" />
        </service>

    </services>

</container>
